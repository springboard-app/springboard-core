<!doctype html>
<html>

<head>
  <title>Editor</title>
  <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-firestore.js"></script>
</head>
<style>
  body {
    padding: 1em
  }

  .top {
    padding-bottom: 1em;
  }

  .step {
    border: .1em solid #ccc;
    border-radius: 1em;
    padding: 1em;
    margin-bottom: 1em;
  }

</style>
<link href="css/springboard.css" rel="stylesheet">
</link>


<body>
  <header>
    <select id="sel">
      <option value="Data">Data</option>
      <option value="Process">Process</option>
      <option value="Dimensionality Reduction"> Dimenisonality Reduction </option>
      <option value="Classifier">Classify</option>
      <option value="Regressor">Regression</option>
    </select>

    <button type="submit" name="button" onclick="newStep(document.getElementById('sel').value)">Submit</button>
  </header>

  <div id="steps" style="float:left; width: 70%">
  </div>

  <div id="variables" style="float:right;">
  </div>


  <script src="js/springboard.js" charset="utf-8"></script>
  <script src="js/springboard-route-guard.js" charset="utf-8"></script>

  <script type="text/javascript">
    function initEditor() {
      firebase.firestore().doc("projects/" + location.hash.slice(1)).onSnapshot(function (snapshot) {
        console.debug(snapshot.data())
      });
    }
    async function start() {
      const user = await firebase.auth.authSignIn;
      await initEditor();
      var steps = document.getElementById("steps");
    }
    function newStep(name) {
      var step = document.createElement("div");
      step.id = name
      step.classList.add("step");

      var heading = document.createElement("h3");
      heading.textContent = name;

      step.append(heading, ...generateStepInputs(name))
      steps.append(step);
    }

    const stepMap = {
      Data: [{
        label: "Data",
        type: "file"
      }],
      Classifier: [
        {
          label: "Classifier",
          type: "select",
          options: ["Support Vector Machine", "Neural Network", "Naive Bayes", "Gaussian Process Classifier", "RBF", "Decision Tree Classifier", "Random Forest Classifier", "Ada Boost Classifier", "Quadratic Discriminant Analysis", "K Neighbors Classifier"]
        }
      ],
      Regressor: [
        {
          label: "Regress",
          type: "select",
          options: ["Support Vector Machine", "Neural Network", "Random Forest Regressor", "Linear Regression", "Ridge", "Decision Tree Regressor"]

        }
      ],
      "Dimensionality Reduction": [
        {
          label: "Dimensionality Reduction",
          type: "select",
          options: ["test1", "test2"]
        }
      ]
    };

    const generateStepInputs = function (stepValue) {
      return stepMap[stepValue].map(desc => {
        if (desc.label) {
          const label = document.createElement("label")
          label.textContent = desc.label
        }
        var inpt;
        if (desc.type == "select") {
          inpt = document.createElement("select")
          desc.options.forEach(option => {
            const optionElement = document.createElement("option");
            optionElement.textContent = optionElement.value = option;
            inpt.append(optionElement);
          });
        }
        else {
          inpt = document.createElement("input");
          Object.assign(inpt, desc);
        }
        const fragment = document.createDocumentFragment()
        fragment.append(desc.label, inpt)
        return fragment
      });
    }
  </script>



</body>

</html>